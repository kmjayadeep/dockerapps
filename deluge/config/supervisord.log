Created by...
___.   .__       .__
\_ |__ |__| ____ |  |__   ____ ___  ___
 | __ \|  |/    \|  |  \_/ __ \\  \/  /
 | \_\ \  |   |  \   Y  \  ___/ >    <
 |___  /__|___|  /___|  /\___  >__/\_ \
     \/        \/     \/     \/      \/
   https://hub.docker.com/u/binhex/

2022-05-17 19:49:47.975385 [info] System information Linux 086e9500fa68 5.10.61-1-lts #1 SMP Fri, 27 Aug 2021 21:20:32 +0000 x86_64 GNU/Linux
2022-05-17 19:49:47.994746 [info] OS_ARCH defined as 'x86-64'
2022-05-17 19:49:48.014206 [info] PUID defined as '1000'
2022-05-17 19:49:48.040203 [info] PGID defined as '1000'
2022-05-17 19:49:48.064727 [info] UMASK defined as '000'
2022-05-17 19:49:48.083734 [info] Setting permissions recursively on '/config'...
2022-05-17 19:49:48.105432 [info] Deleting files in /tmp (non recursive)...
2022-05-17 19:49:48.128909 [info] VPN_ENABLED defined as 'yes'
2022-05-17 19:49:48.149121 [info] VPN_CLIENT defined as 'wireguard'
2022-05-17 19:49:48.174018 [info] VPN_PROV defined as 'custom'
2022-05-17 19:49:48.198271 [info] WireGuard config file (conf extension) is located at /config/wireguard/wg0.conf
2022-05-17 19:49:48.225756 [info] VPN_REMOTE_SERVER defined as '137.184.76.47'
2022-05-17 19:49:48.246093 [info] VPN_REMOTE_PORT defined as '59152'
2022-05-17 19:49:48.263969 [info] VPN_DEVICE_TYPE defined as 'wg0'
2022-05-17 19:49:48.281722 [info] VPN_REMOTE_PROTOCOL defined as 'udp'
2022-05-17 19:49:48.302118 [info] LAN_NETWORK defined as '192.168.1.0/24'
2022-05-17 19:49:48.322610 [info] NAME_SERVERS defined as '1.1.1.1,1.0.0.1'
2022-05-17 19:49:48.342673 [warn] VPN_USER not defined (via -e VPN_USER), assuming authentication via other method
2022-05-17 19:49:48.362527 [warn] VPN_PASS not defined (via -e VPN_PASS), assuming authentication via other method
2022-05-17 19:49:48.382434 [info] ENABLE_PRIVOXY defined as 'yes'
2022-05-17 19:49:48.406396 [info] VPN_INPUT_PORTS not defined (via -e VPN_INPUT_PORTS), skipping allow for custom incoming ports
2022-05-17 19:49:48.426676 [info] VPN_OUTPUT_PORTS not defined (via -e VPN_OUTPUT_PORTS), skipping allow for custom outgoing ports
2022-05-17 19:49:48.446308 [info] DELUGE_DAEMON_LOG_LEVEL defined as 'info'
2022-05-17 19:49:48.466047 [info] DELUGE_WEB_LOG_LEVEL defined as 'info'
2022-05-17 19:49:48.490141 [info] Starting Supervisor...
2022-05-17 19:49:48,633 INFO Included extra file "/etc/supervisor/conf.d/delugevpn.conf" during parsing
2022-05-17 19:49:48,633 INFO Set uid to user 0 succeeded
2022-05-17 19:49:48,634 INFO supervisord started with pid 7
2022-05-17 19:49:49,638 INFO spawned: 'shutdown-script' with pid 163
2022-05-17 19:49:49,641 INFO spawned: 'start-script' with pid 164
2022-05-17 19:49:49,643 INFO spawned: 'watchdog-script' with pid 165
2022-05-17 19:49:49,643 INFO reaped unknown pid 8 (exit status 0)
2022-05-17 19:49:49,648 DEBG 'start-script' stdout output:
[info] VPN is enabled, beginning configuration of VPN

2022-05-17 19:49:49,648 INFO success: shutdown-script entered RUNNING state, process has stayed up for > than 0 seconds (startsecs)
2022-05-17 19:49:49,648 INFO success: start-script entered RUNNING state, process has stayed up for > than 0 seconds (startsecs)
2022-05-17 19:49:49,648 INFO success: watchdog-script entered RUNNING state, process has stayed up for > than 0 seconds (startsecs)
2022-05-17 19:49:49,649 DEBG 'watchdog-script' stdout output:
[info] Deluge-web config file doesn't exist, copying default...

2022-05-17 19:49:49,650 DEBG 'watchdog-script' stdout output:
[info] Deluge config file doesn't exist, copying default...

2022-05-17 19:49:49,651 DEBG 'start-script' stdout output:
[info] Adding 1.1.1.1 to /etc/resolv.conf

2022-05-17 19:49:49,654 DEBG 'start-script' stdout output:
[info] Adding 1.0.0.1 to /etc/resolv.conf

2022-05-17 19:49:49,658 DEBG 'start-script' stdout output:
137.184.76.47

2022-05-17 19:49:49,666 DEBG 'start-script' stdout output:
[info] Attempting to load iptable_mangle module...

2022-05-17 19:49:49,667 DEBG 'start-script' stderr output:
modprobe: FATAL: Module iptable_mangle not found in directory /lib/modules/5.10.61-1-lts

2022-05-17 19:49:49,667 DEBG 'start-script' stdout output:
[warn] Unable to load iptable_mangle module using modprobe, trying insmod...

2022-05-17 19:49:49,669 DEBG 'start-script' stderr output:
insmod: ERROR: could not load module /lib/modules/iptable_mangle.ko: No such file or directory

2022-05-17 19:49:49,669 DEBG 'start-script' stdout output:
[warn] Unable to load iptable_mangle module, you will not be able to connect to the applications Web UI or Privoxy outside of your LAN

2022-05-17 19:49:49,669 DEBG 'start-script' stdout output:
[info] unRAID/Ubuntu users: Please attempt to load the module by executing the following on your host: '/sbin/modprobe iptable_mangle'
[info] Synology users: Please attempt to load the module by executing the following on your host: 'insmod /lib/modules/iptable_mangle.ko'

2022-05-17 19:49:49,693 DEBG 'start-script' stdout output:
[info] Default route for container is 172.22.0.1

2022-05-17 19:49:49,709 DEBG 'start-script' stdout output:
[info] Docker network defined as    172.22.0.0/16

2022-05-17 19:49:49,713 DEBG 'start-script' stdout output:
[info] Adding 192.168.1.0/24 as route via docker eth0

2022-05-17 19:49:49,715 DEBG 'start-script' stdout output:
[info] ip route defined as follows...
--------------------

2022-05-17 19:49:49,716 DEBG 'start-script' stdout output:
default via 172.22.0.1 dev eth0 
172.22.0.0/16 dev eth0 proto kernel scope link src 172.22.0.2 
192.168.1.0/24 via 172.22.0.1 dev eth0 
broadcast 127.0.0.0 dev lo table local proto kernel scope link src 127.0.0.1 
local 127.0.0.0/8 dev lo table local proto kernel scope host src 127.0.0.1 
local 127.0.0.1 dev lo table local proto kernel scope host src 127.0.0.1 
broadcast 127.255.255.255 dev lo table local proto kernel scope link src 127.0.0.1 
broadcast 172.22.0.0 dev eth0 table local proto kernel scope link src 172.22.0.2 
local 172.22.0.2 dev eth0 table local proto kernel scope host src 172.22.0.2 
broadcast 172.22.255.255 dev eth0 table local proto kernel scope link src 172.22.0.2 

2022-05-17 19:49:49,716 DEBG 'start-script' stdout output:
--------------------

2022-05-17 19:49:49,757 DEBG 'start-script' stdout output:
[info] iptables defined as follows...
--------------------

2022-05-17 19:49:49,758 DEBG 'start-script' stdout output:
-P INPUT DROP
-P FORWARD DROP
-P OUTPUT DROP
-A INPUT -s 172.22.0.0/16 -d 172.22.0.0/16 -j ACCEPT
-A INPUT -s 137.184.76.47/32 -i eth0 -j ACCEPT
-A INPUT -i eth0 -p tcp -m tcp --dport 8112 -j ACCEPT
-A INPUT -i eth0 -p udp -m udp --dport 8112 -j ACCEPT
-A INPUT -s 192.168.1.0/24 -d 172.22.0.0/16 -i eth0 -p tcp -m tcp --dport 58846 -j ACCEPT
-A INPUT -s 192.168.1.0/24 -d 172.22.0.0/16 -i eth0 -p tcp -m tcp --dport 8118 -j ACCEPT
-A INPUT -p icmp -m icmp --icmp-type 0 -j ACCEPT
-A INPUT -i lo -j ACCEPT
-A INPUT -i wg0 -j ACCEPT
-A OUTPUT -s 172.22.0.0/16 -d 172.22.0.0/16 -j ACCEPT
-A OUTPUT -d 137.184.76.47/32 -o eth0 -j ACCEPT
-A OUTPUT -o eth0 -p tcp -m tcp --sport 8112 -j ACCEPT
-A OUTPUT -o eth0 -p udp -m udp --sport 8112 -j ACCEPT
-A OUTPUT -s 172.22.0.0/16 -d 192.168.1.0/24 -o eth0 -p tcp -m tcp --sport 58846 -j ACCEPT
-A OUTPUT -s 172.22.0.0/16 -d 192.168.1.0/24 -o eth0 -p tcp -m tcp --sport 8118 -j ACCEPT
-A OUTPUT -p icmp -m icmp --icmp-type 8 -j ACCEPT
-A OUTPUT -o lo -j ACCEPT
-A OUTPUT -o wg0 -j ACCEPT

2022-05-17 19:49:49,758 DEBG 'start-script' stdout output:
--------------------

2022-05-17 19:49:49,760 DEBG 'start-script' stdout output:
[info] Attempting to bring WireGuard interface 'up'...

2022-05-17 19:49:49,766 DEBG 'start-script' stderr output:
Warning: `/config/wireguard/wg0.conf' is world accessible

2022-05-17 19:49:49,770 DEBG 'start-script' stderr output:
[#] ip link add wg0 type wireguard

2022-05-17 19:49:49,771 DEBG 'start-script' stderr output:
[#] wg setconf wg0 /dev/fd/63

2022-05-17 19:49:49,772 DEBG 'start-script' stderr output:
[#] ip -4 address add 10.66.66.4/32 dev wg0

2022-05-17 19:49:49,775 DEBG 'start-script' stderr output:
[#] ip link set mtu 1420 up dev wg0

2022-05-17 19:49:49,776 DEBG 'start-script' stderr output:
[#] resolvconf -a wg0 -m 0 -x

2022-05-17 19:49:49,783 DEBG 'start-script' stderr output:
could not detect a useable init system

2022-05-17 19:49:49,803 DEBG 'start-script' stderr output:
[#] wg set wg0 fwmark 51820

2022-05-17 19:49:49,803 DEBG 'start-script' stderr output:
[#] ip -4 route add 0.0.0.0/0 dev wg0 table 51820

2022-05-17 19:49:49,804 DEBG 'start-script' stderr output:
[#] ip -4 rule add not fwmark 51820 table 51820

2022-05-17 19:49:49,805 DEBG 'start-script' stderr output:
[#] ip -4 rule add table main suppress_prefixlength 0

2022-05-17 19:49:49,807 DEBG 'start-script' stderr output:
[#] sysctl -q net.ipv4.conf.all.src_valid_mark=1

2022-05-17 19:49:49,807 DEBG 'start-script' stderr output:
[#] iptables-restore -n

2022-05-17 19:49:49,815 DEBG 'start-script' stderr output:
[#] '/root/wireguardup.sh'

2022-05-17 19:49:51,070 DEBG 'start-script' stdout output:
[info] Attempting to get external IP using 'http://checkip.amazonaws.com'...

2022-05-17 19:49:51,444 DEBG 'start-script' stdout output:
[info] Successfully retrieved external IP address 137.184.76.47

2022-05-17 19:49:51,446 DEBG 'start-script' stdout output:
[info] Application does not require port forwarding or VPN provider is != pia, skipping incoming port assignment

2022-05-17 19:49:51,447 DEBG 'start-script' stdout output:
[info] WireGuard interface 'up'

2022-05-17 19:49:51,500 DEBG 'watchdog-script' stdout output:
[info] Deluge listening interface IP 0.0.0.0 and VPN provider IP 10.66.66.4 different, marking for reconfigure

2022-05-17 19:49:51,507 DEBG 'watchdog-script' stdout output:
[info] Deluge not running

2022-05-17 19:49:51,511 DEBG 'watchdog-script' stdout output:
[info] Deluge Web UI not running

2022-05-17 19:49:51,515 DEBG 'watchdog-script' stdout output:
[info] Privoxy not running

2022-05-17 19:49:51,515 DEBG 'watchdog-script' stdout output:
[info] Attempting to start Deluge...
[info] Removing deluge pid file (if it exists)...

2022-05-17 19:49:51,819 DEBG 'watchdog-script' stdout output:
[info] Deluge key 'listen_interface' currently has an undefined value
[info] Deluge key 'listen_interface' will have a new value '10.66.66.4'
[info] Writing changes to Deluge config file '/config/core.conf'...

2022-05-17 19:49:52,208 DEBG 'watchdog-script' stdout output:
[info] Deluge key 'outgoing_interface' currently has an undefined value
[info] Deluge key 'outgoing_interface' will have a new value 'wg0'
[info] Writing changes to Deluge config file '/config/core.conf'...

2022-05-17 19:49:52,580 DEBG 'watchdog-script' stdout output:
[info] Deluge process started
[info] Waiting for Deluge process to start listening on port 58846...

2022-05-17 19:49:52,797 DEBG 'watchdog-script' stdout output:
[info] Deluge process listening on port 58846

2022-05-17 19:49:54,986 DEBG 'watchdog-script' stdout output:
[info] No torrents with state 'Error' found

2022-05-17 19:49:54,986 DEBG 'watchdog-script' stdout output:
[info] Starting Deluge Web UI...

2022-05-17 19:49:54,987 DEBG 'watchdog-script' stdout output:
[info] Deluge Web UI started

2022-05-17 19:49:54,988 DEBG 'watchdog-script' stdout output:
[info] Configuring Privoxy...

2022-05-17 19:49:55,001 DEBG 'watchdog-script' stdout output:
[info] Attempting to start Privoxy...

2022-05-17 19:49:56,014 DEBG 'watchdog-script' stdout output:
[info] Privoxy process started
[info] Waiting for Privoxy process to start listening on port 8118...

2022-05-17 19:49:56,028 DEBG 'watchdog-script' stdout output:
[info] Privoxy process listening on port 8118

2022-05-17 19:52:26,215 WARN received SIGTERM indicating exit request
2022-05-17 19:52:26,215 DEBG killing watchdog-script (pid 165) with signal SIGTERM
2022-05-17 19:52:26,215 INFO waiting for shutdown-script, start-script, watchdog-script to die
2022-05-17 19:52:27,217 DEBG fd 16 closed, stopped monitoring <POutputDispatcher at 139986988451248 for <Subprocess at 139986988450144 with name watchdog-script in state STOPPING> (stdout)>
2022-05-17 19:52:27,218 DEBG fd 20 closed, stopped monitoring <POutputDispatcher at 139986988451296 for <Subprocess at 139986988450144 with name watchdog-script in state STOPPING> (stderr)>
2022-05-17 19:52:27,218 INFO stopped: watchdog-script (terminated by SIGTERM)
2022-05-17 19:52:27,218 DEBG received SIGCHLD indicating a child quit
2022-05-17 19:52:27,219 DEBG killing start-script (pid 164) with signal SIGTERM
2022-05-17 19:52:28,220 DEBG fd 11 closed, stopped monitoring <POutputDispatcher at 139986988450864 for <Subprocess at 139986988449952 with name start-script in state STOPPING> (stdout)>
2022-05-17 19:52:28,221 DEBG fd 15 closed, stopped monitoring <POutputDispatcher at 139986988450720 for <Subprocess at 139986988449952 with name start-script in state STOPPING> (stderr)>
2022-05-17 19:52:28,221 INFO stopped: start-script (terminated by SIGTERM)
2022-05-17 19:52:28,221 DEBG received SIGCHLD indicating a child quit
2022-05-17 19:52:28,221 DEBG killing shutdown-script (pid 163) with signal SIGTERM
2022-05-17 19:52:28,222 DEBG 'shutdown-script' stdout output:
[info] Initialising shutdown of process(es) '^deluge-web,^/usr/bin/python /usr/bin/deluged' ...

2022-05-17 19:52:29,224 DEBG fd 8 closed, stopped monitoring <POutputDispatcher at 139986990142112 for <Subprocess at 139986990141680 with name shutdown-script in state STOPPING> (stdout)>
2022-05-17 19:52:29,224 DEBG fd 10 closed, stopped monitoring <POutputDispatcher at 139986988450384 for <Subprocess at 139986990141680 with name shutdown-script in state STOPPING> (stderr)>
2022-05-17 19:52:29,224 INFO stopped: shutdown-script (exit status 0)
2022-05-17 19:52:29,224 DEBG received SIGCHLD indicating a child quit
